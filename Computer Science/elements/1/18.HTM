The context switch code must be carefully crafted, and it relies on hardware support. To avoid confusion and reduce the possibility of error, most operating systems have a common sequence of instructions both for entering the kernel &#8212; whether due to interrupts, processor exceptions or system calls &#8212; and for returning to user level, again regardless of the cause.