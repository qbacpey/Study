<H2 id=user-level-thread-scheduling><FONT style="BACKGROUND-COLOR: #7be1e1"><SPAN class=headers>Title:</SPAN></B><SPAN class=RefText> Implementing threads : User-level thread scheduling</SPAN></FONT></FONT></H2><FONT style="BACKGROUND-COLOR: #7be1e1"><SPAN class=extract>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">Scheduling of the usea-level threads among the available kernel-level threads is done by a thread scheduler implemented in user space. There are two main methods: cooperative and preemptive thread scheduling.</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">&#36825;&#37324;&#23454;&#38469;&#19978;&#35762;&#30340;&#23601;&#26159;&#29992;&#25143;&#32423;&#35843;&#24230;&#22120;&#30340;&#26550;&#26500;&#23454;&#29616;&#65288;mechanism&#65289;&#34429;&#28982;&#23454;&#38469;&#19978;&#20063;&#33021;&#29992;&#20110;&#20869;&#26680;&#32447;&#31243;&#35843;&#24230;&#23601;&#26159;&#20102;</FONT></P></SPAN></FONT>
<H3 id=cooperative-scheduling-of-user-level-threads><FONT style="BACKGROUND-COLOR: #7be1e1">Cooperative scheduling of user-level threads<SPAN class=anchor data-clipboard-text="http://www.it.uu.se/education/course/homepage/os/vt18/module-4/implementing-threads/#cooperative-scheduling-of-user-level-threads"><I class="fa fa-link fa-lg"></I></SPAN></FONT></H3>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">The cooperative model is similar to multiprogramming where a process executes on the CPU until making a I/O request. Cooperative user-level threads execute on the assigned kernel-level thread until they voluntarily give back the kernel thread to the thread manager.</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">In the cooperative model, threads<SPAN>&nbsp;</SPAN><STRONG>yield</STRONG><SPAN>&nbsp;</SPAN>to each other, either explicitly (e.g., by calling a<SPAN>&nbsp;</SPAN><CODE><FONT face="Courier New">yield()</FONT></CODE><SPAN>&nbsp;</SPAN>provided by the user-level thread library) or implicitly (e.g., requesting a lock held by another thread). In the below figure a many-to-one system with cooperative user-level threads is shown.</FONT></P>
<P><A href="http://www.it.uu.se/education/course/homepage/os/vt18/images/module-4/cooperative.png?height=333px" data-featherlight="image"><FONT style="BACKGROUND-COLOR: #7be1e1"><img style="HEIGHT: 207px; WIDTH: 314px" alt="" src="http://www.it.uu.se/education/course/homepage/os/vt18/images/module-4/cooperative.png?height=333px" width=631 height=441></FONT></A></P>
<H3 id=preemptive-scheduling-of-user-level-threads><FONT style="BACKGROUND-COLOR: #7be1e1">Preemptive scheduling of user-level threads<SPAN class=anchor data-clipboard-text="http://www.it.uu.se/education/course/homepage/os/vt18/module-4/implementing-threads/#preemptive-scheduling-of-user-level-threads"><I class="fa fa-link fa-lg"></I></SPAN></FONT></H3>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">The preemptive model is similar to multitasking (aka time sharing). Multitasking is a logical extension of multiprogramming where a timer is set to cause an interrupt at a regular time interval and the running process is replaced if the job requests I/O or if the job is interrupted by the timer. This way, the running job is given a time slice of execution than cannot be exceeded.</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">&#22810;&#20219;&#21153;&#23454;&#38469;&#19978;&#26159;&#22810;&#36947;&#31243;&#24207;&#31995;&#32479;&#30340;&#36923;&#36753;&#25299;&#23637;&#65292;&#35328;&#19979;&#20043;&#24847;&#23601;&#26159;&#65292;&#22810;&#21040;&#31243;&#24207;&#31995;&#32479;&#23454;&#38469;&#19978;&#26159; cooperative &#30340;&#65292;&#30452;&#21040;&#25191;&#34892; yield &#25110;&#32773; IO &#25805;&#20316;&#20043;&#21069;&#37117;&#19981;&#20250;&#25918;&#25163;</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">&#32780;&#22810;&#20219;&#21153;&#30456;&#27604;&#20110;&#22810;&#36947;&#31243;&#24207;&#31995;&#32479;&#30340;&#25299;&#23637;&#20043;&#22788;&#23601;&#22312;&#20110;&#21152;&#20102;&#19968;&#20010;&#35745;&#26102;&#22120;&#65292;&#20801;&#35768;&#35843;&#24230;&#22120;&#22312;&#21512;&#36866;&#30340;&#26102;&#20505;&#65288;&#20026;&#20102;&#30830;&#20445;&#20844;&#24179;&#30340;&#36164;&#28304;&#20998;&#37197;&#65289;&#25191;&#34892;&#36827;&#31243;&#20999;&#25442;&#65292;&#22240;&#27492;&#23454;&#38469;&#19978;&#22810;&#20219;&#21153;&#31995;&#32479;&#37319;&#29992;&#30340;&#35843;&#24230;&#26041;&#24335;&#26159;&#25250;&#20808;&#20013;&#26029;</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">&#25152;&#35859;&#25250;&#20808;&#35843;&#24230;&#27169;&#24335;&#25351;&#30340;&#23601;&#26159;&#65292;&#35745;&#26102;&#22120;&#21487;&#33021;&#20250;&#26681;&#25454;&#35843;&#24230;&#25919;&#31574;&#36873;&#25321;&#26159;&#21542;&#25250;&#20808;&#26576;&#20010;&#32447;&#31243;&#30340;&#25191;&#34892;&#65292;&#28982;&#21518;&#35753;&#20854;&#20182;&#29992;&#25143;&#32447;&#31243;&#20351;&#29992; CPU</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">In the preemptive model, a timer is used to cause execution flow to jump to a central dispatcher thread, which chooses the next thread to run. In the below figure a many-to-one system with preemptive user-level threads is shown.</FONT></P>
<P><A href="http://www.it.uu.se/education/course/homepage/os/vt18/images/module-4/preemptive.png?height=333px" data-featherlight="image"><FONT style="BACKGROUND-COLOR: #7be1e1"><img style="HEIGHT: 263px; WIDTH: 410px" alt="" src="http://www.it.uu.se/education/course/homepage/os/vt18/images/module-4/preemptive.png?height=333px" width=632 height=439></FONT></A></P>
<H3 id=cooperative-and-preemptive-hybrid-scheduling-of-user-level-threads><FONT style="BACKGROUND-COLOR: #7be1e1">Cooperative and preemptive (hybrid) scheduling of user-level threads<SPAN class=anchor data-clipboard-text="http://www.it.uu.se/education/course/homepage/os/vt18/module-4/implementing-threads/#cooperative-and-preemptive-hybrid-scheduling-of-user-level-threads"><I class="fa fa-link fa-lg"></I></SPAN></FONT></H3>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">A hybrid model between cooperative and preemptive scheduling is also possible where a running thread may<SPAN>&nbsp;</SPAN><CODE><FONT face="Courier New">yield()</FONT></CODE><SPAN>&nbsp;</SPAN>or preempted by a timer.</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">&#20004;&#31181;&#27169;&#24335;&#26434;&#20132;&#65288;&#21327;&#20316;&#24335;&#22810;&#20219;&#21153;&#21644;&#25250;&#20808;&#24335;&#22810;&#20219;&#21153;&#26434;&#20132;&#65289;&#30340;&#32467;&#26524;&#23601;&#26159;&#65292;&#32447;&#31243;&#26082;&#21487;&#20197;&#36890;&#36807;&#20027;&#21160;&#25191;&#34892; yield &#35753;&#20986;&#22788;&#29702;&#22120;&#65292;&#20063;&#21487;&#20197;&#34987;&#21160;&#22320;&#35753;&#29992;&#25143;&#32423;&#32447;&#31243;&#31649;&#29702;&#22120;&#26242;&#20572;&#20854;&#25191;&#34892;</FONT></P>
<P><FONT style="BACKGROUND-COLOR: #7be1e1">&nbsp;</FONT></P>
<P><A href="http://www.it.uu.se/education/course/homepage/os/vt18/images/module-4/cooperative-and-preemptive.png?height=333px" data-featherlight="image"><FONT style="BACKGROUND-COLOR: #7be1e1"><img style="HEIGHT: 293px; WIDTH: 434px" alt="" src="http://www.it.uu.se/education/course/homepage/os/vt18/images/module-4/cooperative-and-preemptive.png?height=333px" width=631 height=441></FONT></A><BR><BR></P><BR><BR><FONT style="BACKGROUND-COLOR: #7be1e1">